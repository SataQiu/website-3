<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Koordinator RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Koordinator Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Koordinator" href="/opensearch.xml"><title data-rh="true">Koordinator v0.6: Complete fine-grained CPU orchestration, Resource Reservation and Descheduling | Koordinator</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://koordinator.sh/blog/release-v0.6.0"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Koordinator v0.6: Complete fine-grained CPU orchestration, Resource Reservation and Descheduling | Koordinator"><meta data-rh="true" name="description" content="We are happy to announce the release of Koordinator v0.6.0. Koordinator v0.6.0 brings complete Fine-grained CPU Orchestration, Resource Reservation mechanism, safely Pod Migration mechanism and Descheduling Framework."><meta data-rh="true" property="og:description" content="We are happy to announce the release of Koordinator v0.6.0. Koordinator v0.6.0 brings complete Fine-grained CPU Orchestration, Resource Reservation mechanism, safely Pod Migration mechanism and Descheduling Framework."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-08-04T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/eahydra"><meta data-rh="true" property="article:tag" content="release"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://koordinator.sh/blog/release-v0.6.0"><link data-rh="true" rel="alternate" href="https://koordinator.sh/blog/release-v0.6.0" hreflang="en"><link data-rh="true" rel="alternate" href="https://koordinator.sh/zh-Hans/blog/release-v0.6.0" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://koordinator.sh/blog/release-v0.6.0" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://FKASWWQYOP-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.48d3146e.css">
<link rel="preload" href="/assets/js/runtime~main.f1d81865.js" as="script">
<link rel="preload" href="/assets/js/main.73bfca2c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><div class="announcementBar_IbjG" role="banner"><div class="announcementBarPlaceholder_NC_W"></div><div class="announcementBarContent_KsVm">⭐️ If you like Koordinator, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/koordinator-sh/koordinator">GitHub</a>! ⭐️</div><button type="button" class="clean-btn close announcementBarClose_FG1z" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Koordinator" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="Koordinator" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Koordinator</b></a><a class="navbar__item navbar__link" href="/docs">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/docs/">v1.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/">v1.2 🚧</a></li><li><a class="dropdown__link" href="/docs/">v1.1</a></li><li><a class="dropdown__link" href="/docs/v1.0/">v1.0</a></li><li><a class="dropdown__link" href="/docs/v0.7/">v0.7</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/blog/release-v0.6.0" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/zh-Hans/blog/release-v0.6.0" target="_self" rel="noopener noreferrer" class="dropdown__link">简体中文</a></li></ul></div><a href="https://github.com/koordinator-sh/koordinator" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">All posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/release-v1.1.0">Koordinator v1.1: 让调度感知负载与干扰检测采集</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/release-v1.0.0">Koordinator v1.0: 正式发布</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/release-v0.7.0">Koordinator v0.7: 为任务调度领域注入新活力</a></li><li class="sidebarItem_CF0Q"><a aria-current="page" class="sidebarItemLink_miNk sidebarItemLinkActive_RRTD" href="/blog/release-v0.6.0">Koordinator v0.6: Complete fine-grained CPU orchestration, Resource Reservation and Descheduling</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/release-v0.5.0">Koordinator v0.5: Now With Node Resource Topology And More</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/release-v0.4.0">What&#x27;s New in Koordinator v0.4.0?</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/release-v0.3.0">What&#x27;s New in Koordinator v0.3.0?</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/release-v0.2.0">Koordinator v0.2.0 - Enhanced node-side scheduling capabilities</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/release-v0.1.0">Koordinator v0.1.0 - QoS based scheduling system</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_rzP5" itemprop="headline">Koordinator v0.6: Complete fine-grained CPU orchestration, Resource Reservation and Descheduling</h1><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-08-04T00:00:00.000Z" itemprop="datePublished">August 4, 2022</time> · <!-- -->9 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/eahydra" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://github.com/eahydra.png" alt="Joseph"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/eahydra" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Joseph</span></a></div><small class="avatar__subtitle" itemprop="description">Koordinator maintainer</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>We are happy to announce the release of Koordinator v0.6.0. Koordinator v0.6.0 brings complete Fine-grained CPU Orchestration, Resource Reservation mechanism, safely Pod Migration mechanism and Descheduling Framework.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="install-or-upgrade-to-koordinator-v060">Install or Upgrade to Koordinator v0.6.0<a class="hash-link" href="#install-or-upgrade-to-koordinator-v060" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="install-with-helms">Install with helms<a class="hash-link" href="#install-with-helms" title="Direct link to heading">​</a></h3><p>Koordinator can be simply installed by helm v3.5+, which is a simple command-line tool, and you can get it
from <a href="https://github.com/helm/helm/releases" target="_blank" rel="noopener noreferrer">here</a>.</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Firstly add koordinator charts repository if you haven&#x27;t do this.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ helm repo </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> koordinator-sh https://koordinator-sh.github.io/charts/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># [Optional]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Install the latest version.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ helm </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> koordinator koordinator-sh/koordinator --version </span><span class="token number" style="color:#36acaa">0.6</span><span class="token plain">.0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="upgrade-with-helm">Upgrade with helm<a class="hash-link" href="#upgrade-with-helm" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Firstly add koordinator charts repository if you haven&#x27;t do this.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ helm repo </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> koordinator-sh https://koordinator-sh.github.io/charts/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># [Optional]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Upgrade the latest version.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ helm upgrade koordinator koordinator-sh/koordinator --version </span><span class="token number" style="color:#36acaa">0.6</span><span class="token plain">.0 </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">--force</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>For more details, please refer to the <a href="/docs/installation">installation manual</a>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="fine-grained-cpu-orchestration">Fine-grained CPU Orchestration<a class="hash-link" href="#fine-grained-cpu-orchestration" title="Direct link to heading">​</a></h2><p>In Koordinator v0.5.0, we designed and implemented basic CPU orchestration capabilities. The koord-scheduler supports different CPU bind policies to help LSE/LSR Pods achieve better performance. </p><p>Now in the v0.6 version, we have basically completed the CPU orchestration capabilities originally designed, such as:</p><ul><li>Support default CPU bind policy configured by koord-scheduler for LSR/LSE Pods that do not specify a CPU bind policy</li><li>Support CPU exclusive policy that supports <code>PCPULevel</code> and <code>NUMANodeLevel</code>, which can spread the CPU-bound Pods to different physical cores or NUMA Nodes as much as possible to reduce the interference between Pods.</li><li>Support Node CPU Orchestration API to helper cluster administrators control the CPU orchestration behavior of nodes. The label <code>node.koordinator.sh/cpu-bind-policy</code> constrains how to bind CPU logical CPUs when scheduling. If set with the <code>FullPCPUsOnly</code> that requires that the scheduler must allocate full physical cores. Equivalent to kubelet CPU manager policy option <code>full-pcpus-only=true</code>. If there is no <code>node.koordinator.sh/cpu-bind-policy</code> in the node&#x27;s label, it will be executed according to the policy configured by the Pod or koord-scheduler. The label <code>node.koordinator.sh/numa-allocate-strategy</code> indicates how to choose satisfied NUMA Nodes when scheduling. Support <code>MostAllocated</code> and <code>LeastAllocated</code>.</li><li>koordlet supports the LSE Pods and improve compatibility with existing Guaranteed Pods with static CPU Manager policy. </li></ul><p>Please check out our <a href="/docs/user-manuals/fine-grained-cpu-orchestration">user manual</a> for a detailed introduction and
tutorial.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="resource-reservation">Resource Reservation<a class="hash-link" href="#resource-reservation" title="Direct link to heading">​</a></h2><p>We completed the <code>Resource Reservation API</code> design proposal in v0.5, and implemented the basic Reservation mechanism in the current v0.6 version. </p><p>When you want to use the Reservation mechanism to reserve resources, you do not need to modify the Pod or the existing workloads(e.g. Deployment, StatefulSet). koord-scheduler provides a simple to use API named <code>Reservation</code>, which allows us to reserve node resources for specified pods or workloads even if they haven&#x27;t get created yet. You only need to write the Pod Template and the owner information in the ReservationSpec when creating a Reservation. When koord-scheduler perceives a new Reservation object, it will allocate resources to the Reservation object through the normal Pod scheduling process. After scheduling, koord-scheduler will update the success or failure information to ResourceStatus. If the reservation is successful, and the OwnerReference or Labels of the newly created Pod satisfy the owner information declared earlier, then the newly created Pod will directly reuse the resources held by the Reservation. When the Pod is destroyed, the Reservation object can be reused until the Reservation expires.</p><p><img loading="lazy" alt="image" src="/assets/images/resource-reservation-0c5a187530dd5e3dc9c6e96f97add1ba.svg" width="511" height="371"></p><p>The resource reservation mechanism can help solve or optimize the problems in the following scenarios:</p><ol><li>Preemption: Existing preemption does not guarantee that only preempting pods can allocate preempted resources. With a
reservation, the scheduler should be able to &quot;lock&quot; resources preventing from allocation of other pods with the same
or higher priority.</li><li>Descheduling: For the descheduler, it is better to ensure sufficient resources with the reservation before pods get
rescheduled. Otherwise, rescheduled pods may not be runnable anymore and make the belonging application disrupted.</li><li>Horizontal scaling: Using reservation to achieve more deterministic horizontal scaling. e.g. Submit a reservation and
make sure it is available before scaling up replicas.</li><li>Resource Pre-allocation: Sometimes we want to pre-allocate node resources for future resource demands even if the
resources are not currently allocatable. Reservation can help with this and it should make no physical cost.</li></ol><ul><li>Please check out our <a href="/docs/user-manuals/resource-reservation">user manual</a> for a detailed introduction and
tutorial.</li><li>For more information, please see <a href="/docs/designs/resource-reservation">Design: Resource Reservation</a></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="pod-migration-job">Pod Migration Job<a class="hash-link" href="#pod-migration-job" title="Direct link to heading">​</a></h2><p>Migrating Pods is an important capability that many components (such as descheduler) rely on, and can be used to optimize scheduling or help resolve workload runtime quality issues. We believe that pod migration is a complex process, involving steps such as auditing, resource allocation, and application startup, and is mixed with application upgrading, scaling scenarios, resource operation and maintenance operations by cluster administrators. Therefore, how to manage the stability risk of this process to ensure that the application does not fail due to the migration of Pods is a very critical issue that must be resolved.</p><p>The descheduler in the K8s community evicts pods according to different strategies. However, it does not guarantee whether the evicted Pod has resources available after re-creation. If a large number of newly created Pods are in the Pending state when the resources in the cluster are tight, may lower the application availabilities.</p><p>Koordinator defines a CRD-based Migration/Eviction API named <code>PodMigrationAPI</code>, through which the descheduler or other components can evict or delete Pods more safely. With PodMigrationJob we can track the status of each process in the migration, and perceive scenarios such as upgrading and scaling of the application.</p><p>It&#x27;s simple to use the PodMigrationJob API. Create a <code>PodMigrationJob</code> with the YAML file below to migrate <code>pod-demo-0</code>. </p><div class="codeBlockContainer_I0IT language-yaml theme-code-block"><div class="codeBlockContent_wNvx yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> scheduling.koordinator.sh/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> PodMigrationJob</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> migrationjob</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">paused</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ttl</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 5m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ReservationFirst</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">podRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> pod</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">5f9b977566</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">c7lvk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">status</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">phase</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pending</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl create -f migrationjob-demo.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">podmigrationjob.scheduling.koordinator.sh/migrationjob-demo created</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Then you can query the migration status and query the migration events</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl get podmigrationjob migrationjob-demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                PHASE     STATUS     AGE   NODE     RESERVATION                            PODNAMESPACE   POD                         NEWPOD                      TTL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">migrationjob-demo   Succeed   Complete   37s   node-1   d56659ab-ba16-47a2-821d-22d6ba49258e   default        pod-demo-5f9b977566-c7lvk   pod-demo-5f9b977566-nxjdf   5m0s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl describe podmigrationjob migrationjob-demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Events:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Type    Reason                Age    From               Message</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ----    ------                ----   ----               -------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  ReservationCreated    8m33s  koord-descheduler  Successfully create Reservation </span><span class="token string" style="color:#e3116c">&quot;d56659ab-ba16-47a2-821d-22d6ba49258e&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  ReservationScheduled  8m33s  koord-descheduler  Assigned Reservation </span><span class="token string" style="color:#e3116c">&quot;d56659ab-ba16-47a2-821d-22d6ba49258e&quot;</span><span class="token plain"> to </span><span class="token function" style="color:#d73a49">node</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;node-1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  Evicting              8m33s  koord-descheduler  Try to evict Pod </span><span class="token string" style="color:#e3116c">&quot;default/pod-demo-5f9b977566-c7lvk&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  EvictComplete         8m     koord-descheduler  Pod </span><span class="token string" style="color:#e3116c">&quot;default/pod-demo-5f9b977566-c7lvk&quot;</span><span class="token plain"> has been evicted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal  Complete              8m     koord-descheduler  Bind Pod </span><span class="token string" style="color:#e3116c">&quot;default/pod-demo-5f9b977566-nxjdf&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> Reservation </span><span class="token string" style="color:#e3116c">&quot;d56659ab-ba16-47a2-821d-22d6ba49258e&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li>Please check out our <a href="/docs/user-manuals/pod-migration-job">user manual</a> for a detailed introduction and
tutorial.</li><li>For more information, please see <a href="/docs/designs/pod-migration-job">Design: PodMigrationJob</a>.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="descheduling-framework">Descheduling Framework<a class="hash-link" href="#descheduling-framework" title="Direct link to heading">​</a></h2><p>We implemented a brand new Descheduling Framework in v0.6. </p><p>The existing descheduler in the community can solve some problems, but we think that there are still many aspects of the descheduler that can be improved, for example, it only supports the mode of periodic execution, and does not support the event-triggered mode. It is not possible to extend and configure custom descheduling strategies without invading the existing code of descheduler like kube-scheduler; it also does not support implementing custom evictor.</p><p>We also noticed that the K8s descheduler community also found these problems and proposed corresponding solutions such as <a href="https://github.com/kubernetes-sigs/descheduler/issues/753" target="_blank" rel="noopener noreferrer">#753 Descheduler framework Proposal</a> and <a href="https://github.com/kubernetes-sigs/descheduler/pull/781" target="_blank" rel="noopener noreferrer">PoC #781</a>. The K8s descheduler community tries to implement a descheduler framework similar to the k8s scheduling framework. This coincides with our thinking.</p><p>Overall, these solutions solved most of our problems, but we also noticed that the related implementations were not merged into the main branch. But we review these implementations and discussions, and we believe this is the right direction. Considering that Koordiantor has clear milestones for descheduler-related features, we will implement Koordinator&#x27;s own descheduler independently of the upstream community. We try to use some of the designs in the <a href="https://github.com/kubernetes-sigs/descheduler/issues/753" target="_blank" rel="noopener noreferrer">#753 PR</a> proposed by the community and we will follow the Koordinator&#x27;s compatibility principle with K8s to maintain compatibility with the upstream community descheduler when implementing. Such as independent implementation can also drive the evolution of the upstream community&#x27;s work on the descheduler framework. And when the upstream community has new changes or switches to the architecture that Koordinator deems appropriate, Koordinator will follow up promptly and actively.</p><p>Based on this descheduling framework, it is very easy to be compatible with the existing descheduling strategies in the K8s community, and users can implement and integrate their own descheduling plugins as easily as K8s Scheduling Framework. At the same time, users are also supported to implement Controller in the form of plugins to realize event-based descheduling scenarios. At the same time, the framework integrates the <code>MigrationController</code> based on PodMigrationJob API and serves as the default Evictor plugin to help safely migrate Pods in various descheduling scenarios.</p><p>At present, we have implemented the main body of the framework, including the MigrationController based on PodMigrationJob, which is available as a whole. And we also provide <a href="https://github.com/koordinator-sh/koordinator/blob/main/pkg/descheduler/framework/plugins/removepodsviolatingnodeaffinity/node_affinity.go" target="_blank" rel="noopener noreferrer">a demo descheduling plugin</a>. In the future, we will migrate and be compatible with the existing descheduling policies of the community, as well as the load balancing descheduling plugin provided for co-location scenarios. </p><p>The current framework is still in the early stage of rapid evolution, and there are still many details that need to be improved. Everyone who is interested is welcome to participate in the construction together. We hope that more people can be more assured and simpler to realize the descheduling capabilities they need.</p><ul><li>For more information, please see <a href="/docs/designs/descheduler-framework">Design: descheduling framework</a>.</li><li>For specific implementation, please see <a href="https://github.com/koordinator-sh/koordinator/tree/main/pkg/descheduler" target="_blank" rel="noopener noreferrer">pkg/descheduler</a>.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="about-gpu-scheduling">About GPU Scheduling<a class="hash-link" href="#about-gpu-scheduling" title="Direct link to heading">​</a></h2><p>There are also some new developments in GPU scheduling capabilities that everyone cares about. </p><p>During the iteration of v0.6, we completed the design of <a href="https://github.com/koordinator-sh/koordinator/blob/main/docs/proposals/scheduling/20220629-fine-grained-device-scheduling.md" target="_blank" rel="noopener noreferrer">GPU Share Scheduling</a>, and also completed the design of <a href="https://github.com/koordinator-sh/koordinator/blob/main/docs/proposals/scheduling/20220701-schedule-gang.md" target="_blank" rel="noopener noreferrer">Gang Scheduling</a>. Development of these capabilities is ongoing and will be released in v0.7. </p><p>In addition, in order to explore the mechanism of GPU overcommitment, we have implemented the ability to <a href="https://github.com/koordinator-sh/koordinator/pull/361" target="_blank" rel="noopener noreferrer">report GPU Metric</a> in v0.6.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="whats-coming-next-in-koordinator">What’s coming next in Koordinator<a class="hash-link" href="#whats-coming-next-in-koordinator" title="Direct link to heading">​</a></h2><p>Don&#x27;t forget that Koordinator is developed in the open. You can check out our Github milestone to know more about what
is happening and what we have planned. For more details, please refer to
our <a href="https://github.com/koordinator-sh/koordinator/milestones" target="_blank" rel="noopener noreferrer">milestone</a>. Hope it helps!</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_h6_j"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/release">release</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/koordinator-sh/koordinator.sh/edit/main/blog/2022-08-04-release/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/release-v0.7.0"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Koordinator v0.7: 为任务调度领域注入新活力</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/release-v0.5.0"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Koordinator v0.5: Now With Node Resource Topology And More</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#install-or-upgrade-to-koordinator-v060" class="table-of-contents__link toc-highlight">Install or Upgrade to Koordinator v0.6.0</a><ul><li><a href="#install-with-helms" class="table-of-contents__link toc-highlight">Install with helms</a></li><li><a href="#upgrade-with-helm" class="table-of-contents__link toc-highlight">Upgrade with helm</a></li></ul></li><li><a href="#fine-grained-cpu-orchestration" class="table-of-contents__link toc-highlight">Fine-grained CPU Orchestration</a></li><li><a href="#resource-reservation" class="table-of-contents__link toc-highlight">Resource Reservation</a></li><li><a href="#pod-migration-job" class="table-of-contents__link toc-highlight">Pod Migration Job</a></li><li><a href="#descheduling-framework" class="table-of-contents__link toc-highlight">Descheduling Framework</a></li><li><a href="#about-gpu-scheduling" class="table-of-contents__link toc-highlight">About GPU Scheduling</a></li><li><a href="#whats-coming-next-in-koordinator" class="table-of-contents__link toc-highlight">What’s coming next in Koordinator</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/docs/installation">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/docs/user-manuals/colocation-profile">User Manuals</a></li><li class="footer__item"><a class="footer__link-item" href="/blog/docs/architecture/overview">Architecture</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://join.slack.com/t/koordinator-sh/shared_invite/zt-1756qoub4-Cn4~esfdlfAPsD7cwO2NzA" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack ( #koordinator channel )<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/blog/">DingTalk (GroupID: 33383887)</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/koordinator-sh/koordinator" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/blog/blog">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
        <br>
        <strong>Copyright © 2023 The Koordinator Authors. All rights reserved.</strong></div></div></div></footer></div>
<script src="/assets/js/runtime~main.f1d81865.js"></script>
<script src="/assets/js/main.73bfca2c.js"></script>
</body>
</html>